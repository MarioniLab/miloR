<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Define neighbourhoods on a graph (fast) — makeNhoods • miloR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Define neighbourhoods on a graph (fast) — makeNhoods" />
<meta property="og:description" content="This function randomly samples vertcies on a graph to define neighbourhoods.
These are then refined by computing the median profile for the neighbourhood
in reduced dimensional space and selecting the nearest vertex to this
position. Thus, multiple neighbourhoods may be collapsed down together to
prevent over-sampling the graph space." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">miloR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/milo_demo.html">Differential abundance testing with Milo</a>
    </li>
    <li>
      <a href="../articles/milo_gastrulation.html">Differential abundance testing with Milo - Mouse gastrulation example</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define neighbourhoods on a graph (fast)</h1>
    
    <div class="hidden name"><code>makeNhoods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function randomly samples vertcies on a graph to define neighbourhoods.
These are then refined by computing the median profile for the neighbourhood
in reduced dimensional space and selecting the nearest vertex to this
position. Thus, multiple neighbourhoods may be collapsed down together to
prevent over-sampling the graph space.</p>
    </div>

    <pre class="usage"><span class='fu'>makeNhoods</span>(<span class='no'>x</span>, <span class='kw'>prop</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>21</span>, <span class='kw'>d</span> <span class='kw'>=</span> <span class='fl'>30</span>, <span class='kw'>refined</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>reduced_dims</span> <span class='kw'>=</span> <span class='st'>"PCA"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A <code><a href='Milo.html'>Milo</a></code> object with a non-empty <code>graph</code>
slot. Alternatively an <code>igraph</code> object on which neighbourhoods will
be defined.</p></td>
    </tr>
    <tr>
      <th>prop</th>
      <td><p>A double scalar that defines what proportion of graph vertices
to randomly sample. Must be 0 &lt; prop &lt; 1.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>An integer scalar - the same k used to construct the input graph.</p></td>
    </tr>
    <tr>
      <th>d</th>
      <td><p>The number of dimensions to use if the input is a matrix of cells
X reduced dimensions.</p></td>
    </tr>
    <tr>
      <th>refined</th>
      <td><p>A logical scalar that determines the sampling behaviour, default=TRUE implements the refined sampling scheme.</p></td>
    </tr>
    <tr>
      <th>reduced_dims</th>
      <td><p>If x is an <code><a href='Milo.html'>Milo</a></code> object, a character indicating the name of the <code>reducedDim</code> slot in the
<code><a href='Milo.html'>Milo</a></code> object to use as (default: 'PCA'). If x is an <code>igraph</code> object, a
matrix of vertices X reduced dimensions.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='Milo.html'>Milo</a></code> object containing a list of vertices and
the indices of vertices that constitute the neighbourhoods in the
isIndex slot. If the input is a <code>igraph</code> object then the output
is a list of vertices and the indices of vertices that constitute the
neighbourhoods.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function randomly samples graph vertices, then refines them to collapse
down the number of neighbourhoods to be tested. The refinement behaviour can
be turned off by setting <code>refine=FALSE</code>, however, we do not recommend
this as neighbourhoods will contain a lot of redundancy and lead to an
unncecessarily larger multiple-testing burden.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='no'>igraph</span>)
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fl'>100000</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>100</span>)
<span class='no'>milo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='buildGraph.html'>buildGraph</a></span>(<span class='no'>m</span>, <span class='kw'>d</span><span class='kw'>=</span><span class='fl'>10</span>)</div><div class='output co'>#&gt; <span class='message'>Constructing kNN graph with k:10</span></div><div class='input'>
<span class='no'>milo</span> <span class='kw'>&lt;-</span> <span class='fu'>makeNhoods</span>(<span class='no'>milo</span>, <span class='kw'>prop</span><span class='kw'>=</span><span class='fl'>0.1</span>)</div><div class='output co'>#&gt; <span class='message'>Checking valid object</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Warning: specified d is higher than the total number of dimensions in reducedDim(x, reduced_dims). Falling back to using 11 dimensions</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Rownames not set on reducedDims - setting to row indices</span></div><div class='input'><span class='no'>milo</span></div><div class='output co'>#&gt; class: Milo 
#&gt; dim: 1000 100 
#&gt; metadata(0):
#&gt; assays(1): logcounts
#&gt; rownames: NULL
#&gt; rowData names(0):
#&gt; colnames: NULL
#&gt; colData names(0):
#&gt; reducedDimNames(1): PCA
#&gt; spikeNames(0):
#&gt; altExpNames(0):
#&gt; nhoods dimensions(1): 6
#&gt; nhoodCounts dimensions(2): 1 1
#&gt; nhoodDistances dimension(1): 0
#&gt; graph names(1): graph
#&gt; nhoodIndex names(1): 6
#&gt; nhoodExpression dimension(2): 1 1
#&gt; nhoodReducedDim names(0):
#&gt; nhoodGraph names(0):
#&gt; nhoodAdjacency dimension(0):</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mike Morgan, Emma Dann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


